You are given an integer array `nums` and a positive integer `k`. Return the sum of the maximum and minimum elements of all subarrays with at most `k` elements.